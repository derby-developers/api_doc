<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>DerbyGames API V1</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all_nosearch.js"></script>
  </head>

  <body class="index" data-languages="[&quot;curl&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="curl">curl</a>
        </div>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>For API access, please contact eric@derbygames.com. You will be issued:</p>

<ul>
<li>application name</li>
<li>application group name</li>
<li>cliend ID / secret</li>
</ul>

<h1 id="interacting-with-the-api">Interacting with the API</h1>

<h2 id="making-requests">Making Requests</h2>

<p>All requests:</p>

<ul>
<li>must be over HTTPS</li>
<li>must have an application name, either as a header &lsquo;Application-Name&rsquo; or as a query string &#39;application_name&rsquo;</li>
<li>for POST/PUT requests: must have the content type of <code class="prettyprint">application/json</code></li>
</ul>

<h2 id="localization">Localization</h2>

<p>There is limited support for localization using the <code class="prettyprint">Accept-Language</code> header. Currently, we allow:</p>

<ul>
<li><code class="prettyprint">en</code> - English (default)</li>
<li><code class="prettyprint">es</code> - Spanish</li>
<li><code class="prettyprint">pt</code> - Portuguese (Brazil)</li>
</ul>

<p>Any non supported locale will default to English.</p>

<p>Numbers, currency and datetime donâ€™t rely on localization so they will be returned in standard format.</p>

<h2 id="versioning">Versioning</h2>

<p>This document applies to V1, which is the current live version. To maintain compatibility with this version, it is recommended you add an accepts header:</p>

<p><code class="prettyprint">Accept: version=1</code></p>

<h2 id="objects">Objects</h2>

<p>Any field not explicitly listed should be avoided as it is subject to change.</p>

<h2 id="endpoints">Endpoints</h2>

<p>Sandbox API</p>

<p><code class="prettyprint">https://sandbox-api.derbygames.com/api/</code></p>

<p>Production API</p>

<p><code class="prettyprint">https://api.derbygames.com/api/</code></p>

          <h1 id="errors">Errors</h1>

<aside class="notice">
When a POST request returns an error, a common error format is returned.
</aside>

<h2 id="errors-object">Errors Object</h2>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"blank"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amount"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"can't be blank"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>errors</td>
<td>an array of Error objects</td>
</tr>
</tbody></table>

<h2 id="error-object">Error Object</h2>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"blank"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amount"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"can't be blank"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>a code indicating the type of error</td>
</tr>
<tr>
<td>param (optional)</td>
<td>a parameter that the error applies to, if any</td>
</tr>
<tr>
<td>message</td>
<td>a human-readable message describing the error</td>
</tr>
</tbody></table>

          <h1 id="users">Users</h1>

<h2 id="user-object">User Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="mi">32118</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"gambler@derby.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="s2">"2013-04-04T11:21:03.439-07:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"screen_name"</span><span class="p">:</span><span class="s2">"Wally The Dog"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"authentication_token"</span><span class="p">:</span><span class="s2">"3434fUYT5zTBzJBUxygx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"first_name"</span><span class="p">:</span><span class="s2">"Wally"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last_name"</span><span class="p">:</span><span class="s2">"Dog"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"birth_date"</span><span class="p">:</span><span class="s2">"1976-06-18"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_1"</span><span class="p">:</span><span class="s2">"902 Broadway"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_2"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state_code"</span><span class="p">:</span><span class="s2">"NY"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"city"</span><span class="p">:</span><span class="s2">"New York"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state_code"</span><span class="p">:</span><span class="s2">"NY"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country_code"</span><span class="p">:</span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"postal_code"</span><span class="p">:</span><span class="s2">"10011"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"instant_racing_wager_count"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_instant_racing_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"triple_threat_spin_count"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://avatars.derbycdn.net/1b/ef5a60ad7811e59098a34b698f19df.jpg"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"facebook_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"connected"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="s2">"12125551212"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"mobile_phone_number"</span><span class="p">:</span><span class="s2">"12125551212"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"accounts"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="nt">"type"</span><span class="p">:</span><span class="s2">"virtual"</span><span class="p">,</span><span class="nt">"balance"</span><span class="p">:</span><span class="mf">0.5</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"player_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"application_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"casino"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"level"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_level_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"earned_bonuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"locks"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"max_bet_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"application_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"application_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"racechamp_mobile_app"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"max_bet"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"locks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"place"</span><span class="p">,</span><span class="w"> </span><span class="s2">"show"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exotic-pro"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"longest_wager_streak"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>user id</td>
</tr>
<tr>
<td>email</td>
<td>email address, can be blank</td>
</tr>
<tr>
<td>screen_name</td>
<td>name to be shown to other users</td>
</tr>
<tr>
<td>authentication_token</td>
<td>token for authentication to chat ONLY</td>
</tr>
<tr>
<td>first_name</td>
<td></td>
</tr>
<tr>
<td>last_name</td>
<td></td>
</tr>
<tr>
<td>birth_date</td>
<td>format: YYYY-MM-DD</td>
</tr>
<tr>
<td>address_1</td>
<td>main address line</td>
</tr>
<tr>
<td>address_2</td>
<td>apartment info</td>
</tr>
<tr>
<td>state_code</td>
<td>2 letter state/province code</td>
</tr>
<tr>
<td>city</td>
<td>name of city</td>
</tr>
<tr>
<td>country_code</td>
<td>2 letter ISO country code</td>
</tr>
<tr>
<td>postal_code</td>
<td>postal/zip code</td>
</tr>
<tr>
<td>wager_count</td>
<td>total number of real money wagers</td>
</tr>
<tr>
<td>multi_race_wager_count</td>
<td>total number of multi race wagers placed</td>
</tr>
<tr>
<td>instant_racing_wager_count</td>
<td>total instant (virtual) racing wagers placed</td>
</tr>
<tr>
<td>triple_threat_spin_count</td>
<td>total number of TT spins</td>
</tr>
<tr>
<td>winning_instant_racing_wager_count</td>
<td>the total count of winning instant racing wagers (trophies)</td>
</tr>
<tr>
<td>image_url</td>
<td>full URL of the users avatar</td>
</tr>
<tr>
<td>facebook_status</td>
<td>null if the user isn&rsquo;t connected, otherwise could be &ldquo;connected&rdquo; or &ldquo;expired&rdquo;</td>
</tr>
<tr>
<td>phone_number</td>
<td>phone number</td>
</tr>
<tr>
<td>mobile_phone_number</td>
<td>mobile phone</td>
</tr>
<tr>
<td>accounts</td>
<td>array of Account objects (real money gaming, virtual, etc.)</td>
</tr>
<tr>
<td>player_statuses</td>
<td>array of PlayerStatus objects, each one corresponding to a group of applications</td>
</tr>
<tr>
<td>application_statuses</td>
<td>array of application status objects</td>
</tr>
<tr>
<td>longest_wager_streak</td>
<td>an object containing the wager count of the user&rsquo;s longest streak</td>
</tr>
</tbody></table>

<h2 id="playerstatus-object">PlayerStatus Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"application_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"racechamp_mobile_app"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"level"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_level_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"earned_bonuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"earned_level_up_bonus"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"level_up_bonus_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000000.0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td></td>
</tr>
<tr>
<td>application_group</td>
<td>application group name</td>
</tr>
<tr>
<td>level</td>
<td>numeric level, starting at 1</td>
</tr>
<tr>
<td>progress</td>
<td>progress towards the next level, represented as a number between 0 and 1</td>
</tr>
<tr>
<td>current_level_points</td>
<td>points earned at this level</td>
</tr>
<tr>
<td>earned_bonuses</td>
<td>array of bonus names that are available due to leveling up</td>
</tr>
<tr>
<td>locks</td>
<td>an array of strings indicating locked games, ex. [&ldquo;exotic-pro&rdquo;, &ldquo;super-slots&rdquo;, &ldquo;double-down&rdquo;, &ldquo;jackpot&rdquo;, &ldquo;red-zone&rdquo;, &ldquo;place&rdquo;, &ldquo;show&rdquo;]</td>
</tr>
<tr>
<td>max_bet_amount</td>
<td>a suggested max bet amount</td>
</tr>
</tbody></table>

<aside class="notice">
Users will periodically gain enough points to level-up. When this happens, check the earned_bonuses array for any unlocked level-up bonuses. To award any bonuses, post to the /api/awarded_bonuses endpoint, setting bonus_name to a string in the earned_bonuses array.
</aside>

<h2 id="applicationstatus-object">ApplicationStatus Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="s2">"application_group"</span><span class="err">:</span><span class="w"> </span><span class="s2">"racechamp_mobile_app"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"max_bet_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">200.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"locks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"place"</span><span class="p">,</span><span class="w"> </span><span class="s2">"show"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exotic-pro"</span><span class="p">,</span><span class="w"> </span><span class="s2">"super-slots"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td></td>
</tr>
<tr>
<td>application_group</td>
<td>application group name</td>
</tr>
<tr>
<td>locks</td>
<td>an array of strings indicating locked games, ex. [&ldquo;exotic-pro&rdquo;, &ldquo;super-slots&rdquo;, &ldquo;double-down&rdquo;, &ldquo;jackpot&rdquo;, &ldquo;red-zone&rdquo;, &ldquo;place&rdquo;, &ldquo;show&rdquo;]</td>
</tr>
<tr>
<td>max_bet_amount</td>
<td>a suggested max bet amount</td>
</tr>
</tbody></table>

<aside class="notice">
Leveling-up can also change the locks array. Game names will be removed from this array as they become unlocked to the user.
</aside>

<h2 id="create-user">Create User</h2>

<blockquote>
<p>Create Example</p>
</blockquote>

<p><code class="prettyprint">POST /users</code></p>

<h3 id="using-an-email-and-password">Using an Email and Password</h3>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{ "email": "hi@example.com&amp;password=123456" }' \
  https://api.derbygames.com/api/users
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>yes</td>
<td>email address</td>
</tr>
<tr>
<td>password</td>
<td>yes</td>
<td>password</td>
</tr>
<tr>
<td>inviter_id</td>
<td>no</td>
<td>ID of who invited this user</td>
</tr>
</tbody></table>

<h3 id="using-an-installation-device-id">Using an Installation/Device ID</h3>

<p>See &lsquo;Guest Access&rsquo; under &#39;Generating a New Token&rsquo;.</p>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">User</code> object.</p>

<h2 id="update-user">Update User</h2>

<blockquote>
<p>Update Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X PUT \
  -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{"first_name": "Larry" }' \
  https://api.derbygames.com/api/users
</code></pre>

<p>Add additional information to user, such as address, etc.</p>

<p><code class="prettyprint">PUT /users</code></p>

<p>The follow fields are updatable.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td></td>
</tr>
<tr>
<td>last_name</td>
<td></td>
</tr>
<tr>
<td>birth_date</td>
<td>format: YYYY-MM-DD</td>
</tr>
<tr>
<td>address_1</td>
<td></td>
</tr>
<tr>
<td>address_2</td>
<td></td>
</tr>
<tr>
<td>postal_code</td>
<td>format validated based on country code</td>
</tr>
<tr>
<td>city</td>
<td>only if you are overriding the postal code</td>
</tr>
<tr>
<td>state_code</td>
<td>only if you are overriding the postal code)</td>
</tr>
<tr>
<td>country_code</td>
<td></td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">User</code> object.</p>

<h2 id="get-user">Get User</h2>

<p><code class="prettyprint">GET /user</code></p>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">User</code> object of the user specified in the Authentication header. Otherwise, a 401 will be returned.</p>

          <h1 id="accounts">Accounts</h1>

<h2 id="account-object">Account Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="s2">"virtual"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"balance"</span><span class="p">:</span><span class="mf">489200.0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>type of the account (virtual, rmg, etc.)</td>
</tr>
<tr>
<td>balance</td>
<td>current balance</td>
</tr>
</tbody></table>

<h2 id="get-balances">Get Balances</h2>

<blockquote>
<p>Get Accounts Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: racechamp_mobile_app" \
-H "Authorization: Bearer ABC123" \
https://api.derbygames.com/api/accounts
</code></pre>

<p><code class="prettyprint">GET /accounts</code></p>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">Account</code> objects.</p>

          <h1 id="user-authentication">User Authentication</h1>

<p>User auth is performed using OAuth 2.</p>

<p>Any request consuming user specific data requires a bearer token. Both access and refresh tokens are used. You must get a new access token once it has expired (you will receive a 401). The token needs to be added to the header of each request:</p>

<p><code class="prettyprint">Authorization: Bearer f95f9cf38e829104949ae6e160957f549abab252336c3b1007a5961fda940a09</code></p>

<h2 id="token-object">Token Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c07f8370d9f659fdee0dfea45af6f8b2fe37e4c5d77cf292d990a96ea403ca10"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bearer"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">604800</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f95f9cf38e829104949ae6e160957f549abab252336c3b1007a5961fda940a09"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1478276432</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>token that is included in the Authorization header</td>
</tr>
<tr>
<td>token_type</td>
<td>&lsquo;bearer&rsquo;</td>
</tr>
<tr>
<td>expires_in</td>
<td>time until expiration, in seconds</td>
</tr>
<tr>
<td>refresh_token</td>
<td>refresh token to get a new access token once expires_in is 0</td>
</tr>
<tr>
<td>scope</td>
<td>&#39;user&rsquo;</td>
</tr>
</tbody></table>

<h2 id="generating-a-new-token">Generating a New Token</h2>

<p><code class="prettyprint">POST /api/oauth/tokens</code></p>

<h3 id="via-email-password">Via Email/Password</h3>

<blockquote>
<p>email/password Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{ "grant_type": "password", "email": "user@domain.com", "password": "123456" }' \
  https://api.derbygames.com/api/oauth/token
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>grant_type</td>
<td>yes</td>
<td>&#39;password&rsquo;</td>
</tr>
<tr>
<td>email</td>
<td>yes</td>
<td>email address of the user</td>
</tr>
<tr>
<td>password</td>
<td>yes</td>
<td>password of the user</td>
</tr>
</tbody></table>

<h3 id="guest-access-using-device-id">Guest Access (using device ID)</h3>

<blockquote>
<p>Guest Access Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{ "grant_type": "guest", "device_id": "random123" }' \
  https://api.derbygames.com/api/oauth/token
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>grant_type</td>
<td>yes</td>
<td>&#39;guest&rsquo;</td>
</tr>
<tr>
<td>device_id</td>
<td>yes</td>
<td>GUID of the device/installation</td>
</tr>
</tbody></table>

<p>This will create a user account for the device if the ID is not found.</p>

<h3 id="via-refresh-token">Via Refresh Token</h3>

<p>Once the access token has expired, get a new one using the refresh token.</p>

<blockquote>
<p>Token Refresh Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{ "grant_type": "refresh_token", "refresh_token": "f95f9cf38e829104949ae6e160957f549abab252336c3b1007a5961fda940a09" }' \
  https://api.derbygames.com/api/oauth/token
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>grant_type</td>
<td>yes</td>
<td>&#39;refresh_token&rsquo;</td>
</tr>
<tr>
<td>refresh_token</td>
<td>yes</td>
<td>the refresh token</td>
</tr>
</tbody></table>

<h3 id="with-client-credentials">With Client Credentials</h3>

<blockquote>
<p>API ID/secret example (this is the method needed for uploading race video positions)</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{ "grant_type": "client_credentials", "client_id": "bab252336c3b1007a5961fda940a09", "client_secret": "90a049adf1695a7001b3c633252bab", "scope": "import_instant_racing_race_video_positions" }' \
  https://api.derbygames.com/api/oauth/token
</code></pre>

<h3 id="using-a-facebook-token">Using a Facebook Token</h3>

<blockquote>
<p>Assertion Grant Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Content-Type: application/json" \
  -d '{ "grant_type": "assertion", "assertion": "ABC123" }' \
  https://api.derbygames.com/api/oauth/token
</code></pre>

<p>If the user has linked their Facebook account, you can login using their Facebook token with an assertion grant.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>grant_type</td>
<td>yes</td>
<td>&#39;assertion&rsquo;</td>
</tr>
<tr>
<td>assertion</td>
<td>yes</td>
<td>Facebook token</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Token</code> object if successful, or an error message (with HTTP status 401) if not.</p>

<blockquote>
<p>Failure Example</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid email or password"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"error_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The authorization server encountered an unexpected condition which prevented it from fulfilling the request."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="token-information">Token Information</h2>

<p><code class="prettyprint">GET /api/oauth/token/info</code></p>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Token</code> object.</p>

<h2 id="revoking-a-token-logging-out">Revoking a Token (Logging Out)</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X POST \
  -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/oauth/revoke
</code></pre>

<p>The token specified in the authorization header will be revoked.</p>

<h3 id="returns">Returns</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre>

<p>With a 200 status code</p>

          <h1 id="linked-accounts">Linked Accounts</h1>

<p>Link a user account to Facebook.</p>

<h2 id="create-a-linked-account">Create a Linked Account</h2>

<p>If the user is missing any profile data, it will be filled in as much as possible.</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{ "provider": "facebook", "token": "facebookoauthtoken" }' \
  https://api.derbygames.com/api/linked_accounts
</code></pre>

<p><code class="prettyprint">POST /linked_accounts</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>provider</td>
<td>yes</td>
<td>&lsquo;facebook&rsquo;</td>
</tr>
<tr>
<td>token</td>
<td>yes</td>
<td>OAuth token for the provider. It will be validated.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<table><thead>
<tr>
<th>HTTP Code</th>
<th>reason</th>
<th>description</th>
<th>notes</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>success</td>
<td>User object</td>
<td></td>
</tr>
<tr>
<td>422</td>
<td>validation error</td>
<td>Error object</td>
<td>generally due to in invalid token</td>
</tr>
<tr>
<td>302</td>
<td>account already linked</td>
<td>This Facebook account has been linked to a different user (see below)</td>
<td></td>
</tr>
</tbody></table>

<h3 id="handling-an-account-that-is-already-linked">Handling an account that is already linked</h3>

<p>If the Facebook account is already linked to another user, you should authenticate as that Facebook user using an OAuth assertion grant. The location header will contain the URL you need to use. The response will be a Token obect.</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  [URL returned in the location header from above]
</code></pre>

          <h1 id="saved-credit-cards">Saved Credit Cards</h1>

<p>All credit cards this user has saved.</p>

<h2 id="get-user-39-s-saved-cards">Get User&rsquo;s Saved Cards</h2>

<p><code class="prettyprint">GET /credit_cards</code></p>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">CreditCard</code> object.</p>

          <h1 id="user-notifications">User Notifications</h1>

<h2 id="notification-object">Notification Object</h2>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello, player!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"thumbnail_image_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-11-03T00:00:00.000-07:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"bonus"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"read"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-11-01T14:17:56.991-07:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"claimed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"claimed_at"</span><span class="p">:</span><span class="s2">"2016-11-01T14:52:50.443-07:00"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td></td>
</tr>
<tr>
<td>message</td>
<td>text of the message</td>
</tr>
<tr>
<td>thumbnail_image_url</td>
<td>fully qualified thumbail URL, if provided</td>
</tr>
<tr>
<td>expires_at</td>
<td>expiration</td>
</tr>
<tr>
<td>bonus</td>
<td>Bonus Object, if applicable</td>
</tr>
<tr>
<td>read</td>
<td>boolean if message has been read</td>
</tr>
<tr>
<td>created_at</td>
<td>date of the message</td>
</tr>
<tr>
<td>expired</td>
<td>boolean if notification has expired</td>
</tr>
<tr>
<td>claimed</td>
<td>boolean if this is a bonus that has been claimed</td>
</tr>
<tr>
<td>claimed_at</td>
<td></td>
</tr>
</tbody></table>

<h2 id="get-notifications">Get Notifications</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/notifications
</code></pre>

<p><code class="prettyprint">GET /notifications</code></p>

<h3 id="returns">Returns</h3>

<p>Array of <code class="prettyprint">Notification</code> objects.</p>

<h2 id="mark-message-as-read">Mark Message as Read</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X PUT \
  -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/notifications/1/read
</code></pre>

<p><code class="prettyprint">PUT /notifications/&lt;NOTIFICATION_ID&gt;/read</code></p>

<p>Marks a message as read.</p>

          <h1 id="player-profiles">Player Profiles</h1>

<h2 id="profile-object">Profile Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"screen_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wally T. Dog"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"image_url"</span><span class="p">:</span><span class="s2">"https://avatars.derbycdn.net/1b/ef5a60ad7811e59098a34b698f19df.jpg"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New York"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state_code"</span><span class="p">:</span><span class="s2">"NY"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"games are fun"</span><span class="w"> </span><span class="p">,</span><span class="w">
  </span><span class="nt">"joined_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-04-04T11:21:03-07:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"player_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="nt">"application_group"</span><span class="p">:</span><span class="s2">"instant_racing"</span><span class="p">,</span><span class="nt">"level"</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"stats"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"jackpot"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"instant_racing"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="nt">"key"</span><span class="p">:</span><span class="s2">"wager_count"</span><span class="p">,</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"Wager Count"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="mi">16</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nt">"key"</span><span class="p">:</span><span class="s2">"biggest_win_amount"</span><span class="p">,</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"Biggest Win Amount"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="mf">3600.0</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nt">"key"</span><span class="p">:</span><span class="s2">"races_played"</span><span class="p">,</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"Races Played"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nt">"key"</span><span class="p">:</span><span class="s2">"favorite_game"</span><span class="p">,</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"Favorite Game"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"triple-threat"</span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"casino"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>screen_name</td>
<td>users name</td>
</tr>
<tr>
<td>image_url</td>
<td>fully qualified URL of their avatar</td>
</tr>
<tr>
<td>city</td>
<td>city</td>
</tr>
<tr>
<td>state</td>
<td>2 letter code of the state/province</td>
</tr>
<tr>
<td>country_code</td>
<td>2 letter code of the country</td>
</tr>
<tr>
<td>bio</td>
<td>text blob about the user</td>
</tr>
<tr>
<td>joined_at</td>
<td>date the user registered</td>
</tr>
<tr>
<td>player_statuses</td>
<td>array of slim PlayerStatus objects with application_group/level</td>
</tr>
<tr>
<td>stats</td>
<td>metrics, see below</td>
</tr>
</tbody></table>

<p><code class="prettyprint">stats</code> and <code class="prettyprint">player_statues</code> are split into groups:</p>

<table><thead>
<tr>
<th>Group Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>jackpot</td>
<td>real money gaming</td>
</tr>
<tr>
<td>instant_racing</td>
<td>virtual instant racing games</td>
</tr>
<tr>
<td>casino</td>
<td>virtual casino games</td>
</tr>
</tbody></table>

<h3 id="stats"><code class="prettyprint">stats</code></h3>

<p>jackpot</p>

<table><thead>
<tr>
<th>key</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>public_vip_score</td>
<td>integer of users VIP level</td>
</tr>
<tr>
<td>favorite_count</td>
<td>number of horses favorited</td>
</tr>
<tr>
<td>comment_count</td>
<td>number of comments on horses</td>
</tr>
<tr>
<td>wager_count</td>
<td>total wagers placed</td>
</tr>
<tr>
<td>biggest_win_amount</td>
<td>largest payout</td>
</tr>
<tr>
<td>biggest_win_date</td>
<td>date of the above win</td>
</tr>
</tbody></table>

<p>instant_racing</p>

<table><thead>
<tr>
<th>key</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>wager_count</td>
<td>number of wagers placed</td>
</tr>
<tr>
<td>biggest_win_amount</td>
<td>largest win</td>
</tr>
<tr>
<td>races_played</td>
<td>races that user bet on</td>
</tr>
<tr>
<td>favorite</td>
<td>game</td>
</tr>
</tbody></table>

<p>casino</p>

<table><thead>
<tr>
<th>key</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>N/A</td>
<td></td>
</tr>
</tbody></table>

<h2 id="get-profile">Get Profile</h2>

<blockquote>
<p>Get Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  https://api.derbygames.com/api/profiles/32118
</code></pre>

<p><code class="prettyprint">GET /profiles/&lt;USER_ID&gt;</code></p>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Profile</code> object.</p>

<h2 id="update-profile">Update Profile</h2>

<blockquote>
<p>Update Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X PUT \
  -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{ "bio": "blahblahblah" }' \
  https://api.derbygames.com/api/profile
</code></pre>

<p><code class="prettyprint">PUT /profile</code></p>

<p>Updatable fields</p>

<table><thead>
<tr>
<th>Field</th>
</tr>
</thead><tbody>
<tr>
<td>bio</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Profile</code> object.</p>

<h2 id="remove-avatar">Remove Avatar</h2>

<blockquote>
<p>Avatar Removal Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X DELETE
  -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/profile/avatar
</code></pre>

<p><code class="prettyprint">DELETE /profile/avatar</code></p>

          <h1 id="leaderboards">Leaderboards</h1>

<h2 id="leader-object">Leader Object</h2>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">248941</span><span class="p">,</span><span class="w">
    </span><span class="nt">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">19200</span><span class="p">,</span><span class="w">
    </span><span class="nt">"rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"screen_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe S."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"board"</span><span class="p">:</span><span class="w"> </span><span class="s2">"daily"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://avatars.derbycdn.net/15/121b70929811e491181d7fc65910e6.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"winning_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td></td>
</tr>
<tr>
<td>score</td>
<td>integer score, higher the better</td>
</tr>
<tr>
<td>rank</td>
<td>position in this board</td>
</tr>
<tr>
<td>screen_name</td>
<td>user chosen name</td>
</tr>
<tr>
<td>board</td>
<td>daily, weekly, or all_time</td>
</tr>
<tr>
<td>image_url</td>
<td>avatar of the user</td>
</tr>
<tr>
<td>user_id</td>
<td>only present in streak leaders</td>
</tr>
<tr>
<td>winning_wager_count</td>
<td>the total number of winning wagers a user has made (a.k.a. trophies)</td>
</tr>
</tbody></table>

<h2 id="get-leaders">Get Leaders</h2>

<p><code class="prettyprint">GET /leaders</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>no</td>
<td>number of leaders to show (default: all)</td>
</tr>
<tr>
<td>type</td>
<td>no</td>
<td>&ldquo;winnings&rdquo;, &ldquo;streaks&rdquo;, &ldquo;wagers&rdquo; (default: winnings)</td>
</tr>
<tr>
<td>race_group_id</td>
<td>no</td>
<td>the id of a race group a leaderboard belongs to (defaults to none, giving you the global leaderboard)</td>
</tr>
</tbody></table>

<aside class="notice">
  the &ldquo;wagers&rdquo; type leaderboard is what is used for trophies on the front end
</aside>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">Leader</code> objects.</p>

<h2 id="leaders-near-the-current-user">Leaders near the current user</h2>

<p><code class="prettyprint">GET /headers/around_me</code></p>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">Leader</code> objects.</p>

          <h1 id="promo-codes">Promo Codes</h1>

<h2 id="redeem-a-promo">Redeem a Promo</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X POST
  -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{ "promo_code": "super-fun-code" }' \
  https://api.derbygames.com/api/redeemed_promos
</code></pre>

<p><code class="prettyprint">POST /redeemed_promos</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>promo_code</td>
<td>yes</td>
<td>promo to redeem</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<blockquote>
<p>Success</p>
</blockquote>

<p>A slim <code class="prettyprint">User</code> object with an array of <code class="prettyprint">Account</code> obejcts with updated balances and a slim <code class="prettyprint">Promo</code> object with the amount of the promo.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual"</span><span class="p">,</span><span class="w"> </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mf">2083136.67</span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"promo"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"code"</span><span class="p">:</span><span class="s2">"name-here"</span><span class="p">,</span><span class="nt">"amount"</span><span class="p">:</span><span class="mf">1000000.0</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Array of error messages if it failed.</p>

<blockquote>
<p>Failure</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Promo has already been taken"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="bonuses">Bonuses</h1>

<h2 id="check-if-a-bonus-is-available">Check if a Bonus is Available</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  https://api.derbygames.com/api/awarded_bonuses?bonus_name=racechamp_mobile_app_refill
</code></pre>

<p><code class="prettyprint">GET /api/awarded_bonuses?bonus_name=racechamp_mobile_app_refill</code></p>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">AwardedBonus</code> Objects OR an empty array. If no awarded bonuses are returned, then the requested bonus <em>is</em> available</p>

<h2 id="awardedbonus-object">AwardedBonus Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1585353</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">20000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="s2">"2016-11-28T12:19:17.395-08:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"next_available_at"</span><span class="p">:</span><span class="s2">"2016-11-28T15:19:17.395-08:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bonus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"racechamp_mobile_app_refill"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"award_interval_minutes"</span><span class="p">:</span><span class="w"> </span><span class="mi">180</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual"</span><span class="p">,</span><span class="w"> </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mf">2083136.67</span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>unique ID of this awarded bonus</td>
</tr>
<tr>
<td>amount</td>
<td>amount awarded</td>
</tr>
<tr>
<td>created_at</td>
<td>time when claimed</td>
</tr>
<tr>
<td>next_available_at</td>
<td>time when the next bonus is available (null if not)</td>
</tr>
<tr>
<td>bonus</td>
<td>Bonus Object (name and how often if can be claimed)</td>
</tr>
<tr>
<td>user</td>
<td>slim version of a User Object, with only an Account array</td>
</tr>
</tbody></table>

<h2 id="award-a-bonus">Award a Bonus</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{ "bonus_name": "racechamp_mobile_app_refill" }' \
  https://api.derbygames.com/api/awarded_bonuses
</code></pre>

<p><code class="prettyprint">POST /awarded_bonuses</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>yes</td>
<td>name of the bonus to award</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>An <code class="prettyprint">AwardedBonus</code> object.</p>

          <h1 id="virtual-currency-packages">Virtual Currency Packages</h1>

<h2 id="virtualcurrencypackage-object">VirtualCurrencyPackage Object</h2>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w"> 
    </span><span class="nt">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="mf">4.99</span><span class="p">,</span><span class="w">
    </span><span class="nt">"virtual_currency_value"</span><span class="p">:</span><span class="mf">240000.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"app_store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual_currency_package_4.99"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>package id</td>
</tr>
<tr>
<td>price</td>
<td>purchase price</td>
</tr>
<tr>
<td>virtual_currency_value</td>
<td>number of credits</td>
</tr>
<tr>
<td>app_store_id</td>
<td>ID for in-app-purchasing, applies to both Apple and Google</td>
</tr>
</tbody></table>

<h2 id="get-packages">Get Packages</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/virtual_currency_packages
</code></pre>

<p><code class="prettyprint">GET /virtual_currency_packages</code></p>

<p>Authentication is not required, but recommended.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>promo_code</td>
<td>no</td>
<td>a promo code to show promotional pricing</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">VirtualCurrencyPackage</code> objects.</p>

<h2 id="iap-receipt-validation">IAP Receipt Validation</h2>

<p>After a sucessful in-app purchase, the IAP receipt must be validated in order to place the tokens into the users account.</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X POST
  -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{ "virtual_currency_package_id": 1, "payment": { "transaction_type": "in_app", "service": "apple", receipt: "" } }' \
  https://api.derbygames.com/api/virtual_currency_purchases
</code></pre>

<p><code class="prettyprint">POST /virtual_currency_purchases</code></p>

<table><thead>
<tr>
<th>Paramater</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>virtual_currency_package_id</td>
<td>yes</td>
<td>id of the package</td>
</tr>
<tr>
<td>virtual_currency_offer_id</td>
<td>no</td>
<td>optional ID of an offer the user is claiming</td>
</tr>
<tr>
<td>payment</td>
<td>yes</td>
<td>a Payment object</td>
</tr>
</tbody></table>

<h3 id="payment-object">Payment Object</h3>

<table><thead>
<tr>
<th>Paramater</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>transaction_type</td>
<td>yes</td>
<td>&lsquo;in_app&rsquo;</td>
</tr>
<tr>
<td>service</td>
<td>yes</td>
<td>&#39;google&rsquo; or &#39;apple&rsquo;</td>
</tr>
<tr>
<td>receipt</td>
<td>yes</td>
<td>receipt blob</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>An object with the purchase information and a slim User object with new balances.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"payment_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"virtual_currency_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">200.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual"</span><span class="p">,</span><span class="w"> </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mf">2083136.67</span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="instant-racing-racegroups">Instant Racing: RaceGroups</h1>

<h2 id="racegroup-object">RaceGroup Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"San Francisco"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"City by the bay"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"locked"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
  </span><span class="nt">"unlock_points"</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"unlock_cost"</span><span class="p">:</span><span class="w"> </span><span class="mf">100000.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"unlock_units"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nt">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
  </span><span class="nt">"race_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_place_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_show_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_exacta_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_trifecta_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_superfecta_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"winning_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
  </span><span class="nt">"biggest_win"</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"available_games"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"win-place-show"</span><span class="p">,</span><span class="w"> </span><span class="s2">"trifecta_gold"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"wager_streak"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"alive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"bonus_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"next_live_race"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"track"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ohio"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="nt">"post_datetime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-17T00:05:04-07:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"race_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"destination_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://some-place-to-gamble.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td></td>
</tr>
<tr>
<td>position</td>
<td>the position that this race group should be displayed in a list</td>
</tr>
<tr>
<td>locked</td>
<td>boolean indicating if this group is locked or unlocked for the user</td>
</tr>
<tr>
<td>current_points</td>
<td>current points awarded to unlock this group</td>
</tr>
<tr>
<td>unlock_points</td>
<td>total points to unlock this group</td>
</tr>
<tr>
<td>unlock_cost</td>
<td>coin cost to unlock group</td>
</tr>
<tr>
<td>unlock_units</td>
<td>the number of unlock units (e.g. horseshoes) required to unlock the track</td>
</tr>
<tr>
<td>progress</td>
<td>a number between 0 and 1 indicating the user&rsquo;s progress towards unlocking the race group</td>
</tr>
<tr>
<td>wager_count</td>
<td>total number of wagers a user has placed on this race group</td>
</tr>
<tr>
<td>race_count</td>
<td>total number of races a user has played on this race group</td>
</tr>
<tr>
<td>winning_win_count</td>
<td>number of winning win bets a user has placed on this race group</td>
</tr>
<tr>
<td>winning_place_count</td>
<td>number of winning place bets a user has placed on this race group</td>
</tr>
<tr>
<td>winning_show_count</td>
<td>number of winning show bets a user has placed on this race group</td>
</tr>
<tr>
<td>winning_exacta_count</td>
<td>number of winning exacta bets a user has placed on this race group</td>
</tr>
<tr>
<td>winning_trifecta_count</td>
<td>number of winning trifecta bets a user has placed on this race group</td>
</tr>
<tr>
<td>winning_superfecta_count</td>
<td>number of winning superfecta bets a user has placed on this race group</td>
</tr>
<tr>
<td>winning_count</td>
<td>total number of winning wagers on this race group</td>
</tr>
<tr>
<td>biggest_win</td>
<td>biggest payout for a wager on this race group</td>
</tr>
<tr>
<td>available_games</td>
<td>an array of games that should be enabled for this race group (&ldquo;win-place-show&rdquo;, &ldquo;trifecta_gold&rdquo;, &ldquo;wild_mustang&rdquo;)</td>
</tr>
<tr>
<td>wager_streak</td>
<td>an object describing the user&rsquo;s current wager streak for the race group</td>
</tr>
<tr>
<td>next_live_race</td>
<td>small race object if there is a real live race taking place, null if not</td>
</tr>
</tbody></table>

<h2 id="get-all-race-groups">Get all Race Groups</h2>

<p>Returns all the race groups, ordered as they should be shown to the user.</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/race_groups
</code></pre>

<p><code class="prettyprint">GET /instant_racing/race_groups</code></p>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">RaceGroup</code> objects.</p>

          <h1 id="instant-racing-races">Instant Racing: Races</h1>

<h2 id="race-object">Race Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"e1a0f337-f439-4eb6-849f-e3dc5b47b10d"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"race_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thoroughbred"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"group_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"runners"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"top_trainer"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chestnut"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="mi">61</span><span class="p">,</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span><span class="w">
      </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="mf">4.6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="mf">1.3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="mi">32</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trophies"</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="mf">11.6</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"payouts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.8</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.8</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"place"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"place"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"show"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"show"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">4.6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"show"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">30.2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6/7"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"exacta"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">16.61</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6/7/2/5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"superfecta"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">28.6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6/7/2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trifecta"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"completed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"required_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
      </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"eligible_games"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"trifecta-gold"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"position_timings"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nt">"positions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"players"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"screen_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wally T. Dog"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"image_url"</span><span class="p">:</span><span class="s2">"https://avatars.derbycdn.net/1b/ef5a60ad7811e59098a34b698f19df.jpg"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"runner"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>unique race (per user)</td>
</tr>
<tr>
<td>group_id</td>
<td>the race group id of the current race</td>
</tr>
<tr>
<td>race_type</td>
<td>Thoroughbred, Harness</td>
</tr>
<tr>
<td>decided</td>
<td>whether the race is decided (true or false)</td>
</tr>
<tr>
<td>runners</td>
<td>array of Runner objects</td>
</tr>
<tr>
<td>payouts</td>
<td>array of Payout objects [*]</td>
</tr>
<tr>
<td>position_timings</td>
<td>array of PositionTiming objects with the order of the runners at that moment [*]</td>
</tr>
<tr>
<td>players</td>
<td>array of other players who bet on this race</td>
</tr>
<tr>
<td>tasks</td>
<td>array of Task objects</td>
</tr>
</tbody></table>

<ul>
<li>= only shown after the race is decided</li>
</ul>

<p>There will always be 1 payout for the win pool, 2 for the place pool, 3 for show, and 1 for each exotic pool.</p>

<h2 id="runner-object">Runner Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"top_trainer"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chestnut"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="mi">61</span><span class="p">,</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w">
  </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span><span class="w">
  </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="mf">4.6</span><span class="p">,</span><span class="w">
  </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="mf">1.3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="mi">32</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trophies"</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="w">
  </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="mf">11.6</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>badges</td>
<td>array of badges</td>
</tr>
<tr>
<td>jockey_rating</td>
<td>0-100</td>
</tr>
<tr>
<td>number</td>
<td>position in field</td>
</tr>
<tr>
<td>odds</td>
<td>null, &lsquo;long_shot&rsquo; or &#39;favorite&rsquo; until race is decided, then the runner&rsquo;s odds (e.g. 9/2)</td>
</tr>
<tr>
<td>pedigree_rating</td>
<td>0-100</td>
</tr>
<tr>
<td>speed_rating</td>
<td>0-100</td>
</tr>
<tr>
<td>color</td>
<td>the color of the horse, &ldquo;Bay&rdquo;, &ldquo;Gray&rdquo;, &ldquo;Chestnut&rdquo;, &ldquo;Dark Bay&rdquo; or &ldquo;Black&rdquo;</td>
</tr>
<tr>
<td>win_multiplier</td>
<td>approximate multiple of wager paid out if horse finishes first</td>
</tr>
<tr>
<td>place_multiplier</td>
<td>approximate multiple of wager paid out if horse finishes second</td>
</tr>
<tr>
<td>show_multiplier</td>
<td>approximate multiple of wager paid out if horse finishes third</td>
</tr>
<tr>
<td>trophies</td>
<td>total trophies received</td>
</tr>
<tr>
<td>name</td>
<td>the horse&rsquo;s name [*]</td>
</tr>
<tr>
<td>final_position</td>
<td>the horse&rsquo;s final position [*]</td>
</tr>
</tbody></table>

<ul>
<li>= only shown after the race is decided</li>
</ul>

<table><thead>
<tr>
<th>Badges</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>top_trainer</td>
<td>horse&rsquo;s trainer has an exceptional record</td>
</tr>
<tr>
<td>top_jockey</td>
<td>horse&rsquo;s jockey has an exceptional record</td>
</tr>
<tr>
<td>money_bags</td>
<td>horse&rsquo;s lifetime earnings are in the top 20%</td>
</tr>
<tr>
<td>extra_classy</td>
<td>horse&rsquo;s class rating is in the top 20%</td>
</tr>
<tr>
<td>first_timer</td>
<td>horse&rsquo;s first race</td>
</tr>
<tr>
<td>star_sire</td>
<td>horse&rsquo;s father has an exceptional record</td>
</tr>
<tr>
<td>star_dam</td>
<td>horse&rsquo;s mother has an exceptional record</td>
</tr>
<tr>
<td>streak_one</td>
<td>won its last race</td>
</tr>
<tr>
<td>streak_two</td>
<td>won its last two races</td>
</tr>
<tr>
<td>streak_three</td>
<td>won its last three races</td>
</tr>
<tr>
<td>long_shot</td>
<td>horse has long odds (less likely to win)</td>
</tr>
<tr>
<td>favorite</td>
<td>horse has short odds (more likely to win)</td>
</tr>
</tbody></table>

<h2 id="payout-object">Payout Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">28.6</span><span class="p">,</span><span class="w">
  </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">57</span><span class="p">,</span><span class="w">
  </span><span class="nt">"finish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6/7/2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trifecta"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>wager_amount</td>
<td></td>
</tr>
<tr>
<td>payoff_amount</td>
<td>the amount paid out for a wager of <code class="prettyprint">wager_amount</code></td>
</tr>
<tr>
<td>finish</td>
<td>the finish associated with a winning payout</td>
</tr>
<tr>
<td>pool</td>
<td>the type of wager being paid out (win, place, show, exacta, trifecta, superfecta)</td>
</tr>
</tbody></table>

<h2 id="positiontiming-object">PositionTiming Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nt">"positions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offset</td>
<td>seconds in the video</td>
</tr>
<tr>
<td>positions</td>
<td>array of runner positions (an empty array for the final stretch)</td>
</tr>
</tbody></table>

<h2 id="task-object">Task Object</h2>

<p>An object describing a given task. With the exception of <code class="prettyprint">id</code> and <code class="prettyprint">completed</code>, each of the groups of json attributes in the example to the rigfht are mutually exclusive from each other.</p>

<p>In other words, a task with the <code class="prettyprint">required_wager_count</code> and <code class="prettyprint">wager_count</code> attributes will not have any of the other progress attributes</p>

<p><code class="prettyprint">wager</code> attributes refer to horse racing wagers</p>

<p><code class="prettyprint">slot_play</code>, <code class="prettyprint">amount_won</code> and <code class="prettyprint">amount_played</code> attributes refer to slot plays</p>

<blockquote>
<p>List of all possible attributes in a task object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"completed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_win_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"win_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_place_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"place_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_show_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"show_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_exacta_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exacta_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_trifecta_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trifecta_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_superfecta_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"superfecta_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_trifecta_slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trifecta_slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_superfecta_slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"superfecta_slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_slot_play_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slot_play_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_trifecta_slot_play_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trifecta_slot_play_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_superfecta_slot_play_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"superfecta_slot_play_win_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_amount_played"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_played"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_amount_won"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_won"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">

  </span><span class="nt">"required_symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ace"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"required_symbol_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"symbol_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example of what a specific task object actually looks like</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"completed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"required_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>the id of the task for this user</td>
</tr>
<tr>
<td>completed</td>
<td>a boolean indicating whether the task is completed</td>
</tr>
<tr>
<td>required_wager_count</td>
<td>the required count of horse wagers to complete the task</td>
</tr>
<tr>
<td>wager_count</td>
<td>the number of horse wagers currently placed towards the task</td>
</tr>
<tr>
<td>required_slot_play_count</td>
<td>the required count of slot plays to complete the task</td>
</tr>
<tr>
<td>slot_play_count</td>
<td>the number of slot plays currently played towards the task</td>
</tr>
<tr>
<td>required_slot_play_win_count</td>
<td>the required number of winning slot plays to complete the task</td>
</tr>
<tr>
<td>slot_play_win_count</td>
<td>the current number of slot play wins towards completing the task</td>
</tr>
<tr>
<td>required_amount_played</td>
<td>the required amount played on the slot machines to complete the task</td>
</tr>
<tr>
<td>amount_played</td>
<td>the current amount played towards completing the task</td>
</tr>
<tr>
<td>required_amount_won</td>
<td>the required amount won on the slot machines to complete the task</td>
</tr>
<tr>
<td>amount_won</td>
<td>the current amount won towards completing the task</td>
</tr>
</tbody></table>

<p>The remaining attributes shown in the example all work the same way but are associated with specific wager and slot play types</p>

<h2 id="get-a-race">Get a Race</h2>

<p>Gets the current race for the user. The same race will be returned until the <code class="prettyprint">decide</code> endpoint has been called.</p>

<blockquote>
<p>Example (not group specific)</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/races/current
</code></pre>

<blockquote>
<p>Example (specific race group)</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/races/current?group_id=1
</code></pre>

<p><code class="prettyprint">GET /instant_racing/races/current</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>group_id</td>
<td>no</td>
<td>only return a race from this group</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Race</code> object.</p>

<h2 id="decide-a-race">Decide a Race</h2>

<p>Close the race for wagering. You can then request video and results.</p>

<p><code class="prettyprint">PUT /instant_racing/races/&lt;RACE_ID&gt;/decide</code></p>

          <h1 id="instant-racing-race-videos">Instant Racing: Race Videos</h1>

<aside class="notice">
All endpoints for Race Videos need a token with the import_instant_racing_race_video_positions scope.
</aside>

<h2 id="racevideo-object">RaceVideo Object</h2>
<pre class="highlight json"><code><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"post_time_seconds"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"finish_line_seconds"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"original_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3://bucket/filename.mp4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"video/mp4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ocr_success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"position_timings"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">"positions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td></td>
</tr>
<tr>
<td>post_time_seconds</td>
<td>time, in seconds, when the race starts</td>
</tr>
<tr>
<td>finish_line_seconds</td>
<td>time, in seconds, when the finish line is crossed</td>
</tr>
<tr>
<td>original_url</td>
<td>s3 bucket URL of the original video</td>
</tr>
<tr>
<td>type</td>
<td>video/mp4 or video/flash</td>
</tr>
<tr>
<td>ocr_success</td>
<td>boolean if the OCR was a success</td>
</tr>
<tr>
<td>position_timings</td>
<td>array of offsets/times</td>
</tr>
</tbody></table>

<h2 id="get-racevideos">Get RaceVideos</h2>

<p><code class="prettyprint">GET /api/instant_racing/race_videos</code></p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/race_videos?ocr_success=false
</code></pre>

<table><thead>
<tr>
<th>Paramater</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ocr_success</td>
<td>no</td>
<td>boolean if races passed or failed OCR</td>
</tr>
<tr>
<td>track_id</td>
<td>no</td>
<td>track ID (21 = Penn, Zia = 81, Mahoning = 451)</td>
</tr>
<tr>
<td>clipped</td>
<td>no</td>
<td>boolean if race has been clipped</td>
</tr>
<tr>
<td>limit</td>
<td>no</td>
<td>number of videos to return, max 1000</td>
</tr>
</tbody></table>

<p>Examples: </p>

<p>If you would like to get a list of videos to OCR, pass in the track_id and clipped = true. 
If you would like videos that have failed OCR, pass in ocr_success = false.</p>

<h3 id="returns">Returns</h3>

<p>An array of RaceVideo objects ordered by race date (newest first).</p>

<h2 id="updating-racevideo-position-timings">Updating RaceVideo position timings</h2>

<p><code class="prettyprint">PUT /api/instant_racing/race_videos</code></p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -X PUT
  -d '{ "filename": "foo.mp4", position_timings: [{"offset": 0, "positions": [1, 2, 3, 4] }, {"offset": 10, positions: [2, 1, 3, 4]}]  }' \
  https://api.derbygames.com/api/instant_racing/race_videos
</code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>filename</td>
<td>the video filename</td>
</tr>
<tr>
<td>ocr_success</td>
<td>true/false if the OCR was a success</td>
</tr>
<tr>
<td>position_timings</td>
<td>an array of objects describing the position timings</td>
</tr>
</tbody></table>

          <h1 id="instant-racing-wagers">Instant Racing: Wagers</h1>

<h2 id="wager-object">Wager Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"race"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55e41a9b-f592-4543-9d6c-6cb1ef98e5b9"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"completed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"required_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nt">"wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"decided"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"video_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/api/instant_racing/races/487196ea-04a4-48b1-abd5-13bcff683791/video/playlist.m3u8?..."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"box"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bonus_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"correct_runner_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"runners"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bay"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="s2">"favorite"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"favorite"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"trophies"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"final_position"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"correct"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"game_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win-place-show"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bonus_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"screen_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe S."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://derbycdn.net/towelie.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"practice_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"instant_racing_wager_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"player_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"application_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"casino"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"level"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"current_level_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"max_bet_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"earned_bonuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="nt">"locks"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>wager id</td>
</tr>
<tr>
<td>user_id</td>
<td>user id</td>
</tr>
<tr>
<td>race</td>
<td>a race object</td>
</tr>
<tr>
<td>amount</td>
<td>wager amount</td>
</tr>
<tr>
<td>correct_runner_count</td>
<td>number of correct runners</td>
</tr>
<tr>
<td>payoff_amount</td>
<td>amount the wager paid out (shown when the race has been decided)</td>
</tr>
<tr>
<td>pool</td>
<td>the pool (&ldquo;win&rdquo;, &ldquo;exacta&rdquo;, &ldquo;trifecta&rdquo;, &ldquo;superfecta&rdquo;, &ldquo;win_place&rdquo;, &ldquo;win_place_show&rdquo;)</td>
</tr>
<tr>
<td>game_name</td>
<td>the game that created this wager (&ldquo;super-slots&rdquo;, &ldquo;win-place-show&rdquo;, &ldquo;triple-threat&rdquo;, &ldquo;exotic-pro&rdquo;)</td>
</tr>
<tr>
<td>box</td>
<td>boolean; true if runners can came in any order, false if they must come in exact order</td>
</tr>
<tr>
<td>bonus_multiplier</td>
<td>the payout multiplier being applied to the wager (will be 1 unless the user is on a streak)</td>
</tr>
<tr>
<td>runners</td>
<td>an array of Runner objects</td>
</tr>
<tr>
<td>user</td>
<td>a User object, only on creation</td>
</tr>
</tbody></table>

<aside class="notice">
  The `race` node will contain a `decided` bit and a `video_url` if the `decide` bit is sent with the wager.
</aside>

<h2 id="runner-object">Runner Object</h2>

<aside class="notice">
  These are the fields on the runner object that are only available after a race has been decided
</aside>

<aside class='warning'>
  The `position` field is the zero-based position of the runner in the wager, e.g. first place is `position` 0, second is `position` 1.
  `final_position` is one-based, i.e. `final_position` 1 is first place, 2 is second, etc.
</aside>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>final_position</td>
<td>the position that the runner finished in the race, e.g. 1, 2 or 3 for 1st, 2nd, 3rd</td>
</tr>
<tr>
<td>correct</td>
<td>a boolean that indicates whether the position of the runner in the wager matches the horses finishing position</td>
</tr>
</tbody></table>

<h2 id="get-wagers-on-a-race">Get Wagers on a Race</h2>

<p><code class="prettyprint">GET /instant_racing/races/&lt;RACE_ID&gt;/wagers</code></p>

<aside class="notice">
Because the wager payoffs are calculated asynchronously after a call to `decide`, it may take a few seconds until payoff_amount is available.
</aside>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">Wager</code> objects.</p>

<h2 id="index-wager-object">Index Wager Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"race_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55e41a9b-f592-4543-9d6c-6cb1ef98e5b9"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"box"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bonus_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"correct_runner_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"runners"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bay"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="s2">"favorite"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"favorite"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"trophies"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"final_position"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"correct"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"game_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win-place-show"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bonus_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="new-wager">New Wager</h2>

<p><code class="prettyprint">POST /instant_racing/wagers</code></p>

<blockquote>
<p>Win Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "game_name": "exotic-pro", "pool": "win", "race_id": "46860996-e83d-4ef8-bcd2-8486ed440dea", "runners": [{"number": 3}] }' \
  https://api.derbygames.com/api/instant_racing/wagers
</code></pre>

<blockquote>
<p>Win/Place Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "game_name": "exotic-pro", "pool": "win_place", "race_id": "46860996-e83d-4ef8-bcd2-8486ed440dea", "runners": [{"number": 3}] }' \
  https://api.derbygames.com/api/instant_racing/wagers
</code></pre>

<blockquote>
<p>Win/Place/Show Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "game_name": "win-place-show", "pool": "win_place_show", "race_id": "46860996-e83d-4ef8-bcd2-8486ed440dea", "runners": [{"number": 3}] }' \
  https://api.derbygames.com/api/instant_racing/wagers
</code></pre>

<blockquote>
<p>Exacta Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "game_name": "exotic-pro", "pool": "exacta", "race_id": "46860996-e83d-4ef8-bcd2-8486ed440dea", "runners": [{"number": 3},{"number":5}] }' \
  https://api.derbygames.com/api/instant_racing/wagers
</code></pre>

<blockquote>
<p>Trifeca Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "game_name": "exotic-pro", "pool": "trifecta", "race_id": "46860996-e83d-4ef8-bcd2-8486ed440dea", "runners": [{"number": 3},{"number":5},{"number":2}] }' \
  https://api.derbygames.com/api/instant_racing/wagers
</code></pre>

<blockquote>
<p>Superfecta Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "game_name": "exotic-pro", "pool": "trifecta", "race_id": "46860996-e83d-4ef8-bcd2-8486ed440dea", "runners": [{"number": 3},{"number":5},{"number":2},{"number":1}] }' \
  https://api.derbygames.com/api/instant_racing/wagers
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>race_id</td>
<td>yes</td>
<td>the race id</td>
</tr>
<tr>
<td>pool</td>
<td>yes</td>
<td>the pool (&ldquo;win&rdquo;, &ldquo;exacta&rdquo;, &ldquo;trifecta&rdquo;, &ldquo;superfecta&rdquo;, &ldquo;win_place&rdquo;, &ldquo;win_place_show&rdquo;)</td>
</tr>
<tr>
<td>game_name</td>
<td>yes</td>
<td>the game (&ldquo;super-slots&rdquo;, &ldquo;win-place-show&rdquo;, &ldquo;triple-threat&rdquo;, &ldquo;exotic-pro&rdquo;)</td>
</tr>
<tr>
<td>amount</td>
<td>yes</td>
<td>the wager amount</td>
</tr>
<tr>
<td>runners</td>
<td>yes</td>
<td>an array of objects indicating runner numbers ex: [{number: 2}, {number: 7}]</td>
</tr>
<tr>
<td>decide</td>
<td>no</td>
<td>if true, will decide the associated race and include a video url in the race node in the response</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Wager</code> object.</p>

          <h1 id="instant-racing-video">Instant Racing: Video</h1>

<h2 id="video-object">Video Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"video_url"</span><span class="p">:</span><span class="s2">"https://instant-racing-video.derbycdn.net/2b/2b368e19-ad1a-44a7-835f-98790948707e/256.mp4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"video_duration_seconds"</span><span class="p">:</span><span class="mi">81</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>video_url</td>
<td>URL of the video (link expires in 5 minutes)</td>
</tr>
<tr>
<td>video_duration_seconds</td>
<td>total length, in seconds</td>
</tr>
</tbody></table>

<h2 id="viewing-video">Viewing Video</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/races/&lt;RACE_ID&gt;/video?quality=low
</code></pre>

<p><code class="prettyprint">GET /instant_racing/races/&lt;RACE_ID&gt;/video?quality=[low|high|hls]</code></p>

<p>&lsquo;low&rsquo; and &#39;high&rsquo; will be an MP4. HLS will return a m3u8 playlist.</p>

<aside class="notice">
A race must be decided to get a video URL, otherwise null will be returned. Video must also be requested within 5 minutes of being decided.
</aside>

          <h1 id="instant-racing-slot-plays">Instant Racing: Slot Plays</h1>

<h2 id="slot-play-object">Slot Play Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"screen_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe S."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://derbycdn.net/towelie.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
        </span><span class="nt">"available_balance"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"player_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"application_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"casino"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"level"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"current_level_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"max_bet_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"earned_bonuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="nt">"locks"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"race"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55e41a9b-f592-4543-9d6c-6cb1ef98e5b9"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"completed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"required_slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"slot_play_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"current_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"game_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trifecta-gold"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slot_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"wager_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slot_payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"wagers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"race_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55e41a9b-f592-4543-9d6c-6cb1ef98e5b9"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pool"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trifecta"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"box"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"bonus_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"runners"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bay"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1/9"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"favorite"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="nt">"trophies"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"win_probability"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.81</span><span class="p">,</span><span class="w">
          </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bay"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1/9"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"favorite"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="nt">"trophies"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"win_probability"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.81</span><span class="p">,</span><span class="w">
          </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bay"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"odds"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1/9"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"badges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"favorite"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="nt">"trophies"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"speed_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"pedigree_rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"jockey_rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"win_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"place_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"show_multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"win_probability"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.81</span><span class="p">,</span><span class="w">
          </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"game_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trifecta-gold"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"spins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"reel_results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"payline_results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"reels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
          </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
          </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"paylines"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
          </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>slot play id</td>
</tr>
<tr>
<td>race</td>
<td>a race object</td>
</tr>
<tr>
<td>amount</td>
<td>total slot play amount</td>
</tr>
<tr>
<td>slot_amount</td>
<td>amount placed towards the slot portion of the game</td>
</tr>
<tr>
<td>wager_amount</td>
<td>amount placed towards the trifecta wager portion of the game</td>
</tr>
<tr>
<td>slot_payoff_amount</td>
<td>the amount won by slot portion of the game</td>
</tr>
<tr>
<td>wagers</td>
<td>an array of wagers placed as part of this slot play</td>
</tr>
<tr>
<td>spins</td>
<td>an array of spin objects indicating what happened to the reels</td>
</tr>
</tbody></table>

<h2 id="spin-object">Spin Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"reel_results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">},</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"payline_results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>reel_results</td>
<td>a collection of reel_result objects</td>
</tr>
<tr>
<td>payline_results</td>
<td>a collection of payline_result objects</td>
</tr>
</tbody></table>

<h2 id="reelresult-object">ReelResult Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"reel_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"stop_index"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td>the reel number (0-2)</td>
</tr>
<tr>
<td>reel_id</td>
<td>the id of the set of reel symbols that was used</td>
</tr>
<tr>
<td>stop_index</td>
<td>the index at which the reel stopped after spinning</td>
</tr>
</tbody></table>

<h2 id="paylineresult-object">PaylineResult Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payoff_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td>the payline number</td>
</tr>
<tr>
<td>multiplier</td>
<td>the multiplier awarded from this payline</td>
</tr>
<tr>
<td>payoff_amount</td>
<td>the total amount won from this payline</td>
</tr>
</tbody></table>

<h2 id="new-slot-play">New Slot Play</h2>

<p><code class="prettyprint">POST /instant_racing/slot_plays</code></p>

<blockquote>
<p>Slot Play Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{"race_id": "55e41a9b-f592-4543-9d6c-6cb1ef98e5b9",
  "game_name": "trifecta-gold", amount: 10}' \
  https://api.derbygames.com/api/instant_racing/slot_plays
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>race_id</td>
<td>yes</td>
<td>the race id</td>
</tr>
<tr>
<td>game_name</td>
<td>yes</td>
<td>the game (&ldquo;trifecta-gold&rdquo;)</td>
</tr>
<tr>
<td>amount</td>
<td>yes</td>
<td>the slot play amount</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A <code class="prettyprint">Slot Play</code> object.</p>

          <h1 id="instant-racing-reels">Instant Racing: Reels</h1>

<h2 id="reel-object">Reel Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"symbols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"female-jockey"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"trophy-cup"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"queen"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ace"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"king"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"male-jockey"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"saddle"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"jack"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"horseshoe"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"reel_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="w">
  </span><span class="s2">"game_name"</span><span class="err">:</span><span class="w"> </span><span class="s2">"trifecta-gold"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>reel id</td>
</tr>
<tr>
<td>symbols</td>
<td>an array of the symbols shown in this reel</td>
</tr>
</tbody></table>

<h2 id="get-reels">Get Reels</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/reels
</code></pre>

<p><code class="prettyprint">GET /instant_racing/reels?game_name=trifecta-gold</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>game_name</td>
<td>yes</td>
<td>the name of the game for which reels are required (currently either <code class="prettyprint">trifecta-gold</code> or <code class="prettyprint">wild-mustang</code>)</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">Reel</code> objects.</p>

          <h1 id="instant-racing-paytables">Instant Racing: Paytables</h1>

<h2 id="paytable-object">Paytable Object</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"game_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trifeca-gold"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paylines"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"symbols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"S"</span><span class="p">,</span><span class="s2">"S"</span><span class="p">,</span><span class="s2">"S"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"symbols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"F"</span><span class="p">,</span><span class="s2">"F"</span><span class="p">,</span><span class="s2">"F"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"symbols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"E"</span><span class="p">,</span><span class="s2">"E"</span><span class="p">,</span><span class="s2">"E"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"multiplier"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>game_name</td>
<td>the name of the game</td>
</tr>
<tr>
<td>paylines</td>
<td>array of symbols and their multipliers</td>
</tr>
</tbody></table>

<h2 id="get-paytables">Get Paytables</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/paytables
</code></pre>

<p><code class="prettyprint">GET /instant_racing/paytables</code></p>

<h3 id="returns">Returns</h3>

<p>An array of <code class="prettyprint">Paytable</code> objects.</p>

          <h1 id="instant-racing-example-flow">Instant Racing: Example Flow</h1>

<p>Below is an example of the endpoints you need to get a race, wager on the race, view the video, then see the results.</p>

<h2 id="1-get-a-user-amp-credits">1. Get a User &amp; Credits</h2>

<p>First, you&rsquo;ll need a user token that has credits. If you need to, you can generate a guest user with the example to the right.</p>

<blockquote>
<p>Token Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X POST -H "Application-Name: racechamp_mobile_app" \
  -H "Content-Type: application/json" \
  -d '{ "grant_type": "guest", "device_id": "some-unique-device-id" }' \
  https://api.derbygames.com/api/oauth/token
</code></pre>

<blockquote>
<p>Bonus Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: super-fun-game" \
  -H "Authorization: Bearer ABC123" \
  -H "Content-Type: application/json" \
  -d '{ "bonus_name": "instant_racing_refill" }' \
  https://api.derbygames.com/api/awarded_bonuses
</code></pre>

<p>If that user does not have credits, you can award the refill bonus. You will want the <em>instant_racing_refill</em> bonus.</p>

<h2 id="2-get-a-race">2. Get a Race</h2>

<p>Races are user specific and this endpoint will continue to serve the same race until the decide endpoint is called.</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Authorization: Bearer ABC123" \
  -H "Application-Name: racechamp_mobile_app" \
  https://api.derbygames.com/api/instant_racing/races/current
</code></pre>

<h2 id="3-place-a-wager">3. Place a Wager</h2>

<p>At least one wager must be placed before the next step. See wagering placing above.</p>

<h2 id="4-decide-the-race">4. Decide the Race</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -X PUT -H "Application-Name: racechamp_mobile_app" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/races/&lt;RACE_ID&gt;/decide
</code></pre>

<p>Close wagering and enqueue a job to calculate wager payoffs.</p>

<h2 id="5-get-the-video-url">5. Get the Video URL</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: racechamp_mobile_app" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/races/&lt;RACE_ID&gt;/video?quality=low
</code></pre>

<p>Video must be requested within 5 minutes of hitting the decide endpoint.</p>

<h2 id="6-get-wager-payoffs">6. Get Wager Payoffs</h2>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: racechamp_mobile_app" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/instant_racing/races/&lt;RACE_ID&gt;/wagers
</code></pre>

<p>Wagers will have payoff_amounts now.</p>

<h2 id="7-get-updated-account-balance">7. Get Updated Account Balance</h2>

<p>The balance would be updated a few seconds after the decide enpoint was called, but you should avoid changing the users balance until the video is over to avoid spoilers.</p>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight plaintext"><code>curl -H "Application-Name: racechamp_mobile_app" \
  -H "Authorization: Bearer ABC123" \
  https://api.derbygames.com/api/accounts
</code></pre>

          <h1 id="chat-amp-realtime-data-stream">Chat &amp; Realtime Data Stream</h1>

<p>You can connect to our streaming servers for chat and realtime data. This method is recommended over polling other endpoints. Talk to the nerds for more information.</p>

<blockquote>
<p>Example Script</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://stream.derbyjackpot.com/chat.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Faye</span><span class="p">.</span><span class="nx">Client</span><span class="p">(</span><span class="s1">'https://stream.derbyjackpot.com/chat'</span><span class="p">);</span>

    <span class="nx">auth_extension</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">outgoing</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// on every outgoing message, attach the auth token</span>
        <span class="nx">message</span><span class="p">[</span><span class="s1">'ext'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
          <span class="na">auth_token</span><span class="p">:</span> <span class="s2">"F7VwDj2iw089TJLcLrRO9C6Gz8uVgHUGMftCGGipbJvazZjXVh663UZTTf78Mav0QjKRxTWsgIN89PJNJ14A3IlWeAxMajdzd6iL"</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">client</span><span class="p">.</span><span class="nx">addExtension</span><span class="p">(</span><span class="nx">auth_extension</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">subscription</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'/feed/v1/touchtunes'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// handle message</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>

      <span class="nx">txt</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">message</span><span class="p">[</span><span class="s1">'type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'wager'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">user</span> <span class="o">=</span> <span class="nx">message</span><span class="p">[</span><span class="s1">'user'</span><span class="p">][</span><span class="s1">'screen_name'</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"&lt;img height=30 width=30 src='"</span> <span class="o">+</span> <span class="nx">message</span><span class="p">[</span><span class="s1">'user'</span><span class="p">][</span><span class="s1">'image_url'</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"'&gt;"</span>
        <span class="nx">txt</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">" just wagered "</span> <span class="o">+</span> <span class="nx">message</span><span class="p">[</span><span class="s1">'amount'</span><span class="p">];</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">message</span><span class="p">[</span><span class="s1">'type'</span> <span class="o">==</span> <span class="s1">'win'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">txt</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">" won "</span> <span class="o">+</span> <span class="nx">message</span><span class="p">[</span><span class="s1">'net_payoff_amount'</span><span class="p">];</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">message</span><span class="p">[</span><span class="s1">'type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'race'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">txt</span> <span class="o">=</span> <span class="s2">"Race "</span> <span class="o">+</span> <span class="nx">message</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">message</span><span class="p">[</span><span class="s1">'race_number'</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" changed."</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">$</span><span class="p">(</span><span class="s2">"#content"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;"</span> <span class="o">+</span> <span class="nx">txt</span> <span class="o">+</span> <span class="s2">"&lt;/div&gt;"</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>

  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="curl">curl</a>
          </div>
      </div>
    </div>
  </body>
</html>
